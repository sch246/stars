# 星罗 (Stars)

> 本项目使用 AI 辅助生成

Stars 是一款键盘优先、沉浸式、可视化的知识探索与构建环境。它将复杂的概念体系呈现为一个可自由遨游的二维图谱。用户通过流畅的键盘操作在概念之间“飞行”、编辑和构建关系，旨在提供极致的思维连贯性、深度的学习体验以及对知识结构更精细的掌控。

## ✨ 核心特性

-   **键盘/鼠标优先的沉浸式交互**：通过直观的快捷键（方向键、数字键等）和鼠标（侧键、右键）在知识图谱中“飞行”和操作，最大程度减少鼠标依赖，保持思维流畅。
-   **动态可视化的知识宇宙**：D3 力导向布局，节点与链接以平滑的渐变出现/消失，镜头平滑跟随并支持自由旋转。
-   **上下文感知的可见性**：只显示聚焦节点、其直接邻居、当前悬浮节点（及其邻居）、当前预览节点（及其邻居），以及视野层级内的节点与链接，避免信息过载。
-   **自定义预设链接**：内置默认关系类型，并支持通过编辑器**增删改查**自定义预设链接。预设链接可设置**标签 (label)**、**值 (value)** 和**颜色**。链接以线性渐变表示方向与语义。
-   **连通性保障**：任何删除/覆盖等可能导致节点与“主网络”失联的操作，都会在模拟后给出警告与确认，保护你的知识网络。
-   **槽位系统 (Slots)**：4 个快速切换槽位，支持交换与覆盖存入，HUD 中以小型圆形节点呈现。
-   **实时编辑与持久化**：节点信息、颜色、布局与槽位状态、**预设链接**自动持久化到浏览器 localStorage。
-   **数据导入/导出**：一键导出/导入 JSON，便于备份与迁移。
-   **侧边栏拖动调整**：侧边栏宽度可自由拖动调整，适应不同屏幕和工作流偏好。
-   **智能拖拽**：鼠标左键按住节点时，对该节点持续施加物理吸引力，引导其向鼠标位置移动；松开后节点回归力导向布局，而非直接固定位置，提供更自然的交互体验。点击与拖拽通过时间和位移阈值智能区分，避免误操作。

## 💡 知识结构

### 节点 (Nodes)

-   **核心实体**：每个节点代表一个概念，拥有唯一 UUID、可编辑的标签、摘要与正文（Markdown/HTML）。
-   **动态位置与颜色**：D3 力导向自动优化布局，可通过鼠标物理拖拽影响布局；每个节点可独立设置颜色。
-   **新建节点颜色**：自动分配亮度高、鲜艳的随机色；默认“Origin”节点为白色（#FFFFFF，不可删除）。

### 链接 (Links)

-   **有向关系**：以 source → target 表达方向。
-   **类型系统**：支持**自定义预设类型**（可设置标签、值、颜色），也可输入任意文本作为自定义类型。预设类型通过数字键快速选择。
-   **可视化**：以线性渐变表示方向与语义（预设类型为亮色，自定义/非焦点默认为灰阶）。
-   **覆盖逻辑**：若链接已存在（无论方向），会直接覆盖其类型和方向（默认由源节点指向目标节点）。

## 🌌 可视化与物理

-   **动态视野**：视野层级可调（1–7），自动微调缩放以确保层级内节点可见；HUD 显示当前层级与可见节点数。
-   **力导向模拟范围**：始终对聚焦节点周围 7 层内的节点/链接进行计算，切换焦点或层级时更稳定，减少突变。
-   **摄像机**：视图平滑跟随聚焦节点；自由旋转以阻尼动画过渡；所有节点与链接文本在旋转时保持水平，便于阅读。
-   **出入场动画**：节点/链接以约 0.4s 渐变变更透明度，保证视觉连续性。

## 🎮 操作指南

### 键盘/鼠标（核心）

-   `L` / `鼠标前侧键`：**进入连线模式**。
    1.  选择连接类型（按 `1-9` 选择预设，`Space` 自定义，`D`/`Delete` 断开）。
    2.  当前聚焦节点会泛起选定类型的**颜色光晕**。
    3.  之后任何**改变焦点的操作**（点击其他节点、方向键、槽位跳转、新建节点等）都会将当前节点与新焦点节点进行连线/覆盖/断开。
    4.  连线操作完成后自动退出连线模式。
    5.  按 `Esc` 可随时取消连线模式。
-   `Tab` / `N` / `鼠标后侧键`：新建**独立**节点。
    -   如果在连线模式下使用，则为新建节点并与当前焦点**关联**。
-   `↑` `↓` `←` `→` 或 `/` `?`：按屏幕方向选择最近邻居并导航。
-   `鼠标左键点击节点`：导航到该节点。
-   `鼠标右键点击节点`：删除该节点（触发连通性检查）。
-   `鼠标右键点击连线`：删除该连线（触发连通性检查）。
-   `鼠标右键点击槽位图标`：清空该槽位。
-   `,` `.`：扫描聚焦节点邻居作为“预览节点”；视图会自动旋转使预览节点对齐屏幕正上方。
-   预览中按 `↑` 或 `/`：跳转到预览节点。
-   `<` `>`：持续逆时针/顺时针旋转视图（按住生效）。
-   `=` `-`：调整视野层级（1–7）。
-   `H`：回到“Origin”，并重置视图旋转至 0。
-   `B`：回到导航历史中的上一个节点。
-   `1–4`：与对应槽位节点交换（若槽位为空则存入当前节点）。
-   `Shift+1–4` （`!` `@` `#` `$`）：覆盖存入当前节点到指定槽位。
-   `F2`：聚焦并全选标签编辑框。
-   `Space`：聚焦到摘要编辑框并全选。
-   `Enter`：在画布上查看当前节点正文（全屏模态框）；模态框内按 `Esc` 关闭。
-   `Delete` / `D`：删除当前聚焦节点（触发连通性检查，Origin 节点不可删）。
-   `I`：隐藏/显示左上角的 HUD（包括控制提示）。
-   `` ` ``：打开/关闭“预设关系编辑器”。

### 鼠标（额外）

-   **左键按住命中节点**：对该节点持续施加指向鼠标的物理吸引力。松开即停止，布局逐步稳定。
-   **点击判定**：按下—抬起时间与最大位移小于阈值时视为点击并导航到该节点；否则视为拖拽/施力。
-   **悬停**：在可见节点上显示摘要提示，并高亮该节点及其直接邻居。
-   **滚轮**：缩放视图。
-   **拖动侧边栏**：拖动侧边栏左侧的细长区域，可以调整侧边栏的宽度。

### 交互约束

-   所有鼠标交互严格限于当前可见且透明度 alpha > 0.5 的节点，过渡期间不会误触。

## 🛡️ 连通性保障

-   **主网络定义**：由 Origin 节点和所有非空槽位节点及其可达节点组成。
-   **预判模拟**：删除节点/链接、覆盖槽位、关键导航前，先模拟操作后的连通性。
-   **警告与确认**：若将导致节点与主网络失联，给出节点数量与样例名称提示，用户可选择继续（会清理失联节点）或取消。
-   **历史与槽位清理**：删除节点后清理其在历史与槽位中的引用，保持系统一致性。

## 💾 数据持久化与导入/导出

-   **自动保存到 localStorage**（键：stars_v4），包含节点、链接、布局、颜色、槽位、视野层级以及**自定义预设链接**等。
-   **导出**：将全部数据导出为 JSON 文件（stars_v4.json）。
-   **导入**：从 JSON 文件导入，覆盖现有数据。提供“重置系统”按钮清空数据。

## 🚀 本地运行

Stars 为纯前端应用，无需后端。使用现代浏览器直接打开 `index.html` 即可运行。

## 📸 截图 / 演示

![](/pic.png)

## 🤝 贡献

本项目目前不接受外部代码贡献或功能请求。感谢理解。

## 许可证

MIT License.
